} elif (x == categorias[2]) {
return(1)
}
})
dat$test <- sapply(dat$apply, function(x) {
if (x == categorias[3]) {
return(0)
} else if (x == categorias[2]) {
return(1)
}
})
dat$test <- sapply(dat$apply, function(x) {
if (x == categorias[3]) {
return(0)
} else if (x == categorias[2]) {
return(1)
} else if (x == categorias[1]) {
return(2)
}
})
head(dat)
# Regressing Consistency(n) w.r.t. Score(n-1)
model1h <- lm(test ~ pared, data = dat)
summary(model1h) # => Positive correlation is significant
summary(m)
g1 <- ggplot(dat, aes(pared, test)) +
#  geom_point(alpha = 1/8) +
#  theme_bw() +
#  xlab("Score(n-1)") +
#  ylab("Consistency(n)") +
stat_smooth(method='lm', formula = y~poly(x,1))
library(ggplot2)
g1 <- ggplot(dat, aes(pared, test)) +
#  geom_point(alpha = 1/8) +
#  theme_bw() +
#  xlab("Score(n-1)") +
#  ylab("Consistency(n)") +
stat_smooth(method='lm', formula = y~poly(x,1))
g1
g1 <- ggplot(dat, aes(pared, test)) +
geom_point(alpha = 1/8) +
#  theme_bw() +
#  xlab("Score(n-1)") +
#  ylab("Consistency(n)") +
stat_smooth(method='lm', formula = y~poly(x,1))
g1
newdat <- data.frame(pared=c(0,1))
(phat <- predict(object = m, newdat, type="p"))
phat
## store table
(ctable <- coef(summary(m)))
## calculate and store p values
p <- pnorm(abs(ctable[, "t value"]), lower.tail = FALSE) * 2
## combined table
(ctable <- cbind(ctable, "p value" = p))
(ci <- confint(m))
exp(cbind(coef(m),t(ci)))
setwd("~/Repositorios/SODCL/R")
library(sjmisc)
library(ggplot2)
df1 = read.csv("../Data/humans_only_absent.csv")
df1 <- df1[complete.cases(df1), ]
# Pearson correlation
cor(df1$Consistency, df1$Score_LAG1) # => 0.23
# Regressing Consistency(n) w.r.t. Score(n-1)
model1h <- lm(Consistency ~ Score_LAG1, data = df1)
summary(model1h) # => Positive correlation is significant
g1 <- ggplot(df1, aes(Score_LAG1, Consistency)) +
geom_point(alpha = 1/8) +
theme_bw() +
xlab("Score(n-1)") +
ylab("Consistency(n)") +
stat_smooth(method='lm', formula = y~poly(x,1))
g1
m <- polr(Consistency ~ Score_LAG1, data = df1)
summary(df1$Consistency)
test <- cut(df1$Consistency, breaks = c(0.31, 0.86))
test
table(test)
test <- cut(df1$Consistency, breaks = c(0, 0.31, 0.86, 1))
table(test)
df1$test <- cut(df1$Consistency, breaks = c(0, 0.31, 0.86, 1))
df1$Consistency_ordinal <- cut(df1$Consistency, breaks = c(0, 0.31, 0.86, 1))
m <- polr(Consistency_ordinal ~ Score_LAG1, data = df1)
summary(m)
df1$Consistency_ordinal <- cut(df1$Consistency,
breaks = c(0, 0.31, 0.86, 1),
labels = c("inconsistent", "moderately consistent", "consistent")
)
m <- polr(Consistency_ordinal ~ Score_LAG1, data = df1)
summary(m)
## store table
(ctable <- coef(summary(m)))
## calculate and store p values
p <- pnorm(abs(ctable[, "t value"]), lower.tail = FALSE) * 2
## combined table
(ctable <- cbind(ctable, "p value" = p))
(ci <- confint(m))
exp(cbind(coef(m),t(ci)))
newdat <- data.frame(pared=c(0,1))
(phat <- predict(object = m, newdat, type="p"))
phat
(ci <- confint(m))
exp(cbind(coef(m),t(ci)))
(ci <- confint(m))
exp(cbind(coef(m),t(ci)))
anova(df1$Score_LAG1, df1$Consistency_ordinal)
boxplot(df1$Score_LAG1~df1$Consistency_ordinal)
summary(df1$Consistency)
df1$Consistency_ordinal <- cut(df1$Consistency,
breaks = c(0, 0.31, 0.86, 0.99, 1),
labels = c("inconsistent", "moderately consistent", "consistent", "highly consistent")
)
boxplot(df1$Score_LAG1~df1$Consistency_ordinal)
m <- polr(Consistency_ordinal ~ Score_LAG1, data = df1)
summary(m)
## store table
(ctable <- coef(summary(m)))
## calculate and store p values
p <- pnorm(abs(ctable[, "t value"]), lower.tail = FALSE) * 2
## combined table
(ctable <- cbind(ctable, "p value" = p))
(ci <- confint(m))
exp(cbind(coef(m),t(ci)))
boxplot(df1$Score_LAG1~df1$Consistency_ordinal)
df1$Consistency_ordinal <- cut(df1$Consistency,
breaks = c(0, 0.31, 0.86, 1),
labels = c("inconsistent", "moderately consistent", "consistent")
)
boxplot(df1$Score_LAG1~df1$Consistency_ordinal)
by(df1$Score_LAG1, df1$Consistency_ordinal, shapiro.test)
## Finding odds
(ci <- confint(m))
exp(cbind(coef(m),t(ci)))
## Cutting the Consistency variable into three levels
summary(df1$Consistency)
df1$Consistency_ordinal <- cut(df1$Consistency,
breaks = c(0, 0.31, 0.86, 1),
labels = c("inconsistent", "moderately consistent", "consistent")
)
## Drawing boxplot
boxplot(df1$Score_LAG1~df1$Consistency_ordinal)
## Running OLR model
m <- polr(Consistency_ordinal ~ Score_LAG1, data = df1)
summary(m)
## store table
(ctable <- coef(summary(m)))
## calculate and store p values
p <- pnorm(abs(ctable[, "t value"]), lower.tail = FALSE) * 2
## combined table
(ctable <- cbind(ctable, "p value" = p))
## Finding odds
(ci <- confint(m))
exp(cbind(coef(m),t(ci)))
## Drawing boxplot
boxplot(df1$Score_LAG1~df1$Consistency_ordinal,
xlab="Consistency")
## Drawing boxplot
boxplot(df1$Score_LAG1~df1$Consistency_ordinal,
xlab="Consistency",
ylab="Score on previous round"
)
setwd("~/Repositorios/SODCL/R")
setwd("~/Repositorios/SODCL/R")
g2 <- ggplot(df1, aes(Consistency)) +
geom_density(size=1) +
#  scale_y_continuous(limits = c(0, 5)) +
xlab("Consistency") +
theme_bw()
g2
library(sjmisc)
library(ggplot2)
df1 = read.csv("../Data/humans_only_absent.csv")
df1 <- df1[complete.cases(df1), ]
# Pearson correlation
cor(df1$Consistency, df1$Score_LAG1) # => 0.23
## Cutting the Consistency variable into three levels
summary(df1$Consistency)
g2 <- ggplot(df1, aes(Consistency)) +
geom_density(size=1) +
#  scale_y_continuous(limits = c(0, 5)) +
xlab("Consistency") +
theme_bw()
g2
df1$Consistency_ordinal <- cut(df1$Consistency,
breaks = c(0, 0.31, 0.86, 1),
labels = c("inconsistent", "moderately consistent", "consistent")
)
## Drawing boxplot
boxplot(df1$Score_LAG1~df1$Consistency_ordinal,
xlab="Consistency",
ylab="Score on previous round"
)
## Running OLR model
m <- polr(Consistency_ordinal ~ Score_LAG1, data = df1)
summary(m)
## store table
(ctable <- coef(summary(m)))
## calculate and store p values
p <- pnorm(abs(ctable[, "t value"]), lower.tail = FALSE) * 2
## store table
(ctable <- coef(summary(m)))
summary(m)
library(MASS)
## Running OLR model
m <- polr(Consistency_ordinal ~ Score_LAG1, data = df1)
summary(m)
## store table
(ctable <- coef(summary(m)))
## calculate and store p values
p <- pnorm(abs(ctable[, "t value"]), lower.tail = FALSE) * 2
## combined table
(ctable <- cbind(ctable, "p value" = p))
## combined table
(ctable <- cbind(ctable, "p value" = p))
## Running OLR model
m <- polr(Consistency_ordinal ~ Score_LAG1, data = df1)
summary(m)
## store table
(ctable <- coef(summary(m)))
## calculate and store p values
p <- pnorm(abs(ctable[, "t value"]), lower.tail = FALSE) * 2
## combined table
(ctable <- cbind(ctable, "p value" = p))
## Finding odds
(ci <- confint(m))
exp(cbind(coef(m),t(ci)))
## Cutting the Score_LAG1 variable into three levels
summary(df1$Score_LAG1)
g3 <- ggplot(df1, aes(Score_LAG1)) +
geom_density(size=1) +
#  scale_y_continuous(limits = c(0, 5)) +
xlab("Score on previous round") +
theme_bw()
g3
df1$SocreLAG_ordinal <- cut(df1$Consistency,
breaks = c(-200, 15, 28, 1),
labels = c("inconsistent", "moderately consistent", "consistent")
)
## Drawing boxplot
boxplot(df1$ScoreLAG1_ordianl~df1$Consistency_ordinal,
xlab="Consistency",
ylab="Score on previous round"
)
df1$SocreLAG_ordinal <- cut(df1$Consistency,
breaks = c(-200, 15, 28, 1),
labels = c("inconsistent", "moderately consistent", "consistent")
)
df1$SocreLAG_ordinal
df1$SocreLAG_ordinal <- cut(df1$Consistency,
breaks = c(-200, 15, 28, 1),
labels = c("bad score", "moderate score", "high score")
)
## Drawing boxplot
boxplot(df1$ScoreLAG_ordianl~df1$Consistency_ordinal,
xlab="Consistency",
ylab="Score on previous round"
)
## Drawing boxplot
boxplot(df1$ScoreLAG_ordinal~df1$Consistency_ordinal,
xlab="Consistency",
ylab="Score on previous round"
)
df1$ScoreLAG_ordinal <- cut(df1$Consistency,
breaks = c(-200, 15, 28, 1),
labels = c("bad score", "moderate score", "high score")
)
## Drawing boxplot
boxplot(df1$ScoreLAG_ordinal~df1$Consistency_ordinal,
xlab="Consistency",
ylab="Score on previous round"
)
library(sjmisc)
library(ggplot2)
library(foreign)
library(MASS)
df1 = read.csv("../Data/humans_only_absent.csv")
df1 <- df1[complete.cases(df1), ]
## Cutting the Consistency variable into three levels
summary(df1$Consistency)
g2 <- ggplot(df1, aes(Consistency)) +
geom_density(size=1) +
#  scale_y_continuous(limits = c(0, 5)) +
xlab("Consistency") +
theme_bw()
g2
df1$Consistency_ordinal <- cut(df1$Consistency,
breaks = c(0, 0.31, 0.86, 1),
labels = c("inconsistent", "moderately consistent", "consistent")
)
## Cutting the Score_LAG1 variable into three levels
summary(df1$Score_LAG1)
g3 <- ggplot(df1, aes(Score_LAG1)) +
geom_density(size=1) +
#  scale_y_continuous(limits = c(0, 5)) +
xlab("Score on previous round") +
theme_bw()
g3
df1$ScoreLAG_ordinal <- cut(df1$Consistency,
breaks = c(-200, 15, 28, 1),
labels = c("bad score", "moderate score", "high score")
)
## Drawing boxplot
boxplot(df1$ScoreLAG_ordinal~df1$Consistency_ordinal,
xlab="Consistency",
ylab="Score on previous round"
)
## Drawing boxplot
boxplot(df1$Score_LAG1~df1$Consistency_ordinal,
xlab="Consistency",
ylab="Score on previous round"
)
boxplot(df1$Consistency_ordinal~df1$ScoreLAG_ordinal,
xlab="Consistency",
ylab="Score on previous round"
)
boxplot(df1$Consistency~df1$ScoreLAG_ordinal,
xlab="Consistency",
ylab="Score on previous round"
)
boxplot(df1$Consistency~df1$ScoreLAG_ordinal,
xlab="Score on previous round",
ylab="Consistency"
)
## Running OLR model
m <- polr(Consistency_ordinal ~ Score_LAG1, data = df1)
table(df1$ScoreLAG_ordinal, df1$Consistency_ordinal)
df1$ScoreLAG_ordinal <- cut(df1$Consistency,
breaks = c(-200, 15, 28, 32),
labels = c("bad score", "moderate score", "high score")
)
table(df1$ScoreLAG_ordinal, df1$Consistency_ordinal)
df1$ScoreLAG_ordinal <- cut(df1$Score_LAG1,
breaks = c(-200, 15, 28, 32),
labels = c("bad score", "moderate score", "high score")
)
table(df1$ScoreLAG_ordinal, df1$Consistency_ordinal)
boxplot(df1$Consistency~df1$ScoreLAG_ordinal,
xlab="Score on previous round",
ylab="Consistency"
)
## Running OLR model
m <- polr(Consistency_ordinal ~ ScoreLAG_ordinal, data = df1)
summary(m)
## store table
(ctable <- coef(summary(m)))
## calculate and store p values
p <- pnorm(abs(ctable[, "t value"]), lower.tail = FALSE) * 2
## combined table
(ctable <- cbind(ctable, "p value" = p))
## Finding odds
(ci <- confint(m))
exp(cbind(coef(m),t(ci)))
library(foreign)
library(MASS)
dat <- read.dta("https://stats.idre.ucla.edu/stat/data/ologit.dta")
head(dat)
boxplot(dat$apply~dat$pared,
xlab="Pared",
ylab="Apply"
)
boxplot(dat$pared~dat$apply,
ylab="Pared",
xlab="Apply"
)
table(dat$pared, dat$apply)
summary(m)
m <- polr(apply ~ pared, data = dat)
summary(m)
table(dat$pared, dat$apply)
(ci <- confint(m))
exp(cbind(coef(m),t(ci)))
library(sjmisc)
library(ggplot2)
library(foreign)
library(MASS)
df1 = read.csv("../Data/humans_only_absent.csv")
df1 <- df1[complete.cases(df1), ]
# Pearson correlation
cor(df1$Consistency, df1$Score_LAG1) # => 0.23
# Regressing Consistency(n) w.r.t. Score(n-1)
model1h <- lm(Consistency ~ Score_LAG1, data = df1)
summary(model1h) # => Positive correlation is significant
g1 <- ggplot(df1, aes(Score_LAG1, Consistency)) +
geom_point(alpha = 1/8) +
theme_bw() +
xlab("Score(n-1)") +
ylab("Consistency(n)") +
stat_smooth(method='lm', formula = y~poly(x,1))
g1
## Cutting the Consistency variable into three levels
summary(df1$Consistency)
g2 <- ggplot(df1, aes(Consistency)) +
geom_density(size=1) +
#  scale_y_continuous(limits = c(0, 5)) +
xlab("Consistency") +
theme_bw()
g2
df1$Consistency_ordinal <- cut(df1$Consistency,
breaks = c(0, 0.31, 0.86, 1),
labels = c("inconsistent", "moderately consistent", "consistent")
)
## Cutting the Score_LAG1 variable into three levels
summary(df1$Score_LAG1)
g3 <- ggplot(df1, aes(Score_LAG1)) +
geom_density(size=1) +
#  scale_y_continuous(limits = c(0, 5)) +
xlab("Score on previous round") +
theme_bw()
g3
g3
df1$ScoreLAG_ordinal <- cut(df1$Score_LAG1,
breaks = c(-200, 15, 28, 32),
labels = c("bad score", "moderate score", "high score")
)
table(df1$ScoreLAG_ordinal, df1$Consistency_ordinal)
## Drawing boxplot
boxplot(df1$Score_LAG1~df1$Consistency_ordinal,
xlab="Consistency",
ylab="Score on previous round"
)
boxplot(df1$Consistency~df1$ScoreLAG_ordinal,
xlab="Score on previous round",
ylab="Consistency"
)
## Running OLR model
m <- polr(Consistency_ordinal ~ ScoreLAG_ordinal, data = df1)
summary(m)
## store table
(ctable <- coef(summary(m)))
## calculate and store p values
p <- pnorm(abs(ctable[, "t value"]), lower.tail = FALSE) * 2
## combined table
(ctable <- cbind(ctable, "p value" = p))
## Finding odds
(ci <- confint(m))
exp(cbind(coef(m),t(ci)))
## Drawing boxplot
boxplot(df1$Score_LAG1~df1$Consistency_ordinal,
xlab="Consistency",
ylab="Score on previous round"
)
## Cutting the Consistency variable into three levels
summary(df1$Consistency)
g2 <- ggplot(df1, aes(Consistency)) +
geom_density(size=1) +
#  scale_y_continuous(limits = c(0, 5)) +
xlab("Consistency") +
theme_bw()
g2
df1$Consistency_ordinal <- cut(df1$Consistency,
breaks = c(0, 0.31, 0.86, 1),
labels = c("inconsistent", "moderately consistent", "consistent")
)
## Drawing boxplot
boxplot(df1$Score_LAG1~df1$Consistency_ordinal,
xlab="Consistency",
ylab="Score on previous round"
)
boxplot(df1$Consistency~df1$ScoreLAG_ordinal,
xlab="Score on previous round",
ylab="Consistency"
)
g1 <- ggplot(df1, aes(Score_LAG1, Consistency)) +
geom_point(alpha = 1/8) +
theme_bw() +
xlab("Score(n-1)") +
ylab("Consistency(n)") +
stat_smooth(method='lm', formula = y~poly(x,1))
g1
boxplot(df1$Consistency~df1$ScoreLAG_ordinal,
xlab="Score on previous round",
ylab="Consistency"
)
table(df1$ScoreLAG_ordinal, df1$Consistency_ordinal)
## Running OLR model
m <- polr(Consistency_ordinal ~ ScoreLAG_ordinal, data = df1)
summary(m)
df1$ScoreLAG_ordinal <- cut(df1$Score_LAG1,
breaks = c(-200, 15, 28, 32),
labels = c("low score", "moderate score", "high score")
)
table(df1$ScoreLAG_ordinal, df1$Consistency_ordinal)
## Drawing boxplot
boxplot(df1$Score_LAG1~df1$Consistency_ordinal,
xlab="Consistency",
ylab="Score on previous round"
)
boxplot(df1$Consistency~df1$ScoreLAG_ordinal,
xlab="Score on previous round",
ylab="Consistency"
)
## Running OLR model
m <- polr(Consistency_ordinal ~ ScoreLAG_ordinal, data = df1)
summary(m)
## store table
(ctable <- coef(summary(m)))
## calculate and store p values
p <- pnorm(abs(ctable[, "t value"]), lower.tail = FALSE) * 2
## combined table
(ctable <- cbind(ctable, "p value" = p))
## Finding odds
(ci <- confint(m))
exp(cbind(coef(m),t(ci)))
table(df1$ScoreLAG_ordinal, df1$Consistency_ordinal)
chisq.test(tbl)
tbl <- table(df1$ScoreLAG_ordinal, df1$Consistency_ordinal)
tbl
chisq.test(tbl)
tbl <- table(df1$ScoreLAG_ordinal, df1$Consistency_ordinal)
tbl
chisq.test(tbl)
